(this.webpackJsonpprofile=this.webpackJsonpprofile||[]).push([[0],{224:function(t,e,n){},289:function(t,e){},300:function(t,e){},329:function(t,e){},330:function(t,e){},476:function(t,e,n){"use strict";n.r(e);var a=n(0),s=n.n(a),i=n(68),o=n.n(i),r=(n(224),n(225),n(1)),c=n.n(r),l=n(69),h=n(75),d=n(76),p=n(84),u=n(81),f=n(491),b=n(477),m=n(492),j=n(490),g=n(494),x=n(147),O=n(488),k=n(489),v=n(496),y=n(493),C=n(106),S=n.n(C),w=n(210),I=n(94),T=n(206),M=n(9),z="https://ipfs.io/ipfs/",U=function(t){Object(p.a)(n,t);var e=Object(u.a)(n);function n(t){var a;Object(h.a)(this,n);var s="text",i=!1;return(a=e.call(this,t)).props.content.startsWith("https://")?(s="https",i=!0):a.props.content.startsWith("ipfs://")&&(s="ipfs",i=!0),a.state={text:!0,lazy:i,type:s,lazyText:"loading...",iconColor:"grey"},a}return Object(d.a)(n,[{key:"formatHTMLText",value:function(t){return t=t.replace(/(https?:\/\/[^\s]+)/gm,'<a href="$1" target="_blank">$1</a>'),Object(M.jsx)("div",{children:Object(T.a)(t)})}},{key:"loadAndSetFromURL",value:function(){var t=Object(l.a)(c.a.mark((function t(e,n){var a,s,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.a.get(e);case 2:a=t.sent,(s=a.headers["content-type"]).search("text/plain")>=0?this.setState({lazyText:a.data,iconColor:n}):s.search("image")>=0?this.setState({lazyText:"",lazyImage:e,iconColor:n}):s.search("application/json")>=0?(i=a.data,this.setState({lazyText:i.text,lazyImage:i.image?"".concat(z).concat(i.image):null,iconColor:n})):this.setState({lazyText:"Content not supported.",iconColor:n});case 5:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=Object(l.a)(c.a.mark((function t(){var e;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.state.lazy){t.next=11;break}t.t0=this.state.type,t.next="https"===t.t0?4:"ipfs"===t.t0?7:4;break;case 4:return t.next=6,this.loadAndSetFromURL(this.props.content,"red");case 6:return t.abrupt("break",11);case 7:return e="".concat(z).concat(this.props.content.replace("ipfs://","")),t.next=10,this.loadAndSetFromURL(e,"teal");case 10:return t.abrupt("break",11);case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return Object(M.jsxs)(y.a,{fluid:!0,raised:!0,style:{background:"dark"===this.props.theme?"black":"white"},children:[this.state.lazyImage&&Object(M.jsx)(w.a,{fluid:!0,wrapped:!0,src:this.state.lazyImage}),Object(M.jsx)(y.a.Content,{children:Object(M.jsx)(y.a.Description,{style:{color:"dark"===this.props.theme?"white":"black"},children:this.formatHTMLText(this.state.lazy?this.state.lazyText:this.props.content)})}),Object(M.jsxs)(y.a.Content,{extra:!0,style:{color:"dark"===this.props.theme?"white":"black"},children:[this.state.lazy&&Object(M.jsxs)(I.a,{attached:"bottom right",color:this.state.iconColor,size:"tiny",children:[this.state.type," "]}),this.props.date]})]})}}]),n}(s.a.Component);function A(t){return t.split("").map((function(t){return t.charCodeAt(0).toString(16).padStart(2,"0")})).join("")}var L=function(t){Object(p.a)(n,t);var e=Object(u.a)(n);function n(t){var a;Object(h.a)(this,n),a=e.call(this,t);var s=localStorage.getItem("feed");return s=s?JSON.parse(s):[],a.state={feed:s},a}return Object(d.a)(n,[{key:"loadData",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n,a,s,i,o=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:t.t0=parseInt(this.props.chain),t.next=80001===t.t0?5:137===t.t0?7:9;break;case 5:return n="https://api-testnet.polygonscan.com",t.abrupt("break",10);case 7:return n="https://api.polygonscan.com",t.abrupt("break",10);case 9:return t.abrupt("return");case 10:return t.next=12,S.a.get("".concat(n,"/api?module=account&action=txlist&address=").concat(e,"&startblock=1&endblock=99999999&sort=asc"));case 12:if(a=t.sent,"1"===(s=a.data).status&&Array.isArray(s.result)){t.next=16;break}return t.abrupt("return");case 16:i=s.result.filter((function(t){return t.to.toLowerCase()===o.props.id.toLowerCase()})).filter((function(t){return"0x"!==t.input})).filter((function(t,e,n){return n.findIndex((function(e){return e.hash===t.hash}))===e})).map((function(t){var e,n=t.hash,a=t.input,s=t.timeStamp;return{hash:n,content:(e=a,decodeURIComponent(e.replace(/\s+/g,"").replace(/[0-9a-f]{2}/g,"%$&").substring(2))),date:new Date(1e3*parseInt(s)).toString().substring(0,24)}})).reverse(),this.setState({feed:i}),localStorage.setItem("feed",JSON.stringify(i));case 19:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(M.jsxs)(O.a,{children:[Object(M.jsx)(k.a,{hidden:!0}),Object(M.jsx)(k.a,{hidden:!0}),this.props.id&&Object(M.jsx)(v.a,{style:{color:"dark"===this.props.theme?"white":"black"},content:"Address ".concat(this.props.id.substring(0,6),"...").concat(this.props.id.slice(-4)," Chain ").concat(this.props.chain)}),Object(M.jsx)(k.a,{hidden:!0}),Object(M.jsx)(y.a.Group,{children:this.props.id&&this.state.feed.map((function(e){return Object(M.jsx)(U,Object(x.a)(Object(x.a)({},e),{},{theme:t.props.theme}),e.hash)}))})]})}}]),n}(s.a.Component),P=n(263).create,R=function(t){Object(p.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(h.a)(this,n),t=e.call(this);var i="undefined"===typeof window.ethereum,o=localStorage.getItem("id")||"",r=localStorage.getItem("chain")||null,c=localStorage.getItem("ipfs")||"http://localhost:5001";return t.ipfs=P(c),t.fileUploadRef=Object(a.createRef)(),t.state={ipfsHost:c,theme:localStorage.getItem("theme")||"light",connect:!!o,disableConnect:i,id:o,chain:r,addModalOpen:!1,ipfsModalOpen:!1,postMessage:"",disableRefresh:!1,ipfs:!1,fileUploaded:null},t.profile=s.a.createRef(),t}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.setTheme(this.state.theme),this.ipfs.isOnline().then((function(e){t.setState({ipfs:!0})}))}},{key:"onClickToggleTheme",value:function(){"dark"===this.state.theme?this.setTheme("light"):this.setTheme("dark")}},{key:"setTheme",value:function(t){this.setState({theme:t}),localStorage.setItem("theme",t),document.body.classList.remove("dark"),document.body.classList.remove("light"),document.body.classList.add(t)}},{key:"onClickConnect",value:function(){var t=this;this.state.connect?(this.setState({connect:!1,id:""}),localStorage.removeItem("feed"),localStorage.removeItem("id")):window.ethereum.request({method:"eth_requestAccounts"}).then((function(e){var n=parseInt(window.ethereum.chainId),a=e[0];localStorage.setItem("id",a),localStorage.setItem("chain",n),t.setState({connect:!0,id:a,chain:n}),t.profile.current.loadData(a)})).catch((function(e){t.setState({connect:!1,id:""}),localStorage.removeItem("feed"),localStorage.removeItem("id")}))}},{key:"onClickAdd",value:function(){this.setState({addModalOpen:!0,postMessage:"",fileUploaded:null})}},{key:"onClickPostToMetamask",value:function(){var t=Object(l.a)(c.a.mark((function t(){var e,n,a,s,i,o,r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.state.postMessage,!this.state.fileUploaded){t.next=7;break}return t.next=4,this.ipfs.add(this.state.fileUploaded,{pin:!0});case 4:a=t.sent,s=a.cid,e=JSON.stringify({text:e,image:s.toString()});case 7:if(!(e instanceof File||e.length>60&&!e.startsWith("https://"))){t.next=15;break}return t.next=10,this.ipfs.add(e,{pin:!0});case 10:i=t.sent,o=i.cid,n=A("ipfs://".concat(o.toString())),t.next=16;break;case 15:n=A(e);case 16:window.ethereum.request({method:"eth_sendTransaction",params:[{to:this.state.id,from:this.state.id,data:"0x".concat(n)}]}).then((function(t){})).catch((function(t){})).finally((function(t){return r.setState({addModalOpen:!1,postMessage:"",fileUploaded:null})}));case 17:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(M.jsxs)("div",{className:this.state.theme,children:[Object(M.jsxs)(f.a,{fixed:"top",compact:!0,borderless:!0,inverted:"dark"===this.state.theme,children:[Object(M.jsx)(f.a.Item,{header:!0,content:"Profile"}),this.state.id&&Object(M.jsx)(f.a.Item,{icon:"refresh",disabled:this.state.disableRefresh,onClick:function(){t.profile.current.loadData(t.state.id),t.setState({disableRefresh:!0}),setTimeout((function(){return t.setState({disableRefresh:!1})}),2e3)}}),Object(M.jsx)(f.a.Item,{position:"right",icon:"cubes",onClick:function(){return t.setState({ipfsModalOpen:!0})}}),Object(M.jsx)(f.a.Item,{icon:"dark"===this.state.theme?"moon":"sun",onClick:this.onClickToggleTheme.bind(this)}),Object(M.jsx)(f.a.Item,{name:this.state.disableConnect?"Install Metamask":this.state.connect?"Disconnect":"Connect",icon:this.state.disableConnect?"warning":"power",onClick:this.state.disableConnect?function(){window.open("https://metamask.io","_blank")}:this.onClickConnect.bind(this)})]}),Object(M.jsx)(L,{ref:this.profile,theme:this.state.theme,id:this.state.id,chain:this.state.chain}),Object(M.jsx)(b.a,{circular:!0,icon:"add",size:"big",onClick:this.onClickAdd.bind(this),style:{display:this.state.connect?"block":"none",position:"fixed",margin:"2em",bottom:"0px",right:"0px",zIndex:6}}),Object(M.jsxs)(m.a,{open:this.state.addModalOpen,children:[Object(M.jsx)(m.a.Header,{children:"Post a new Message"}),Object(M.jsx)(m.a.Content,{children:Object(M.jsxs)(m.a.Description,{children:[Object(M.jsx)(j.a,{maxLength:this.state.ipfs?1e3:60,fluid:!0,placeholder:"Enter your messsage",onChange:function(e,n){var a=n.value;return t.setState({postMessage:a})}}),this.state.ipfs?Object(M.jsxs)("div",{style:{marginTop:"1em"},children:[Object(M.jsx)(b.a,{content:"Upload Image",labelPosition:"left",icon:"file",onClick:function(){return t.fileUploadRef.current.click()}}),Object(M.jsx)("input",{ref:this.fileUploadRef,type:"file",accept:"image/*",hidden:!0,onChange:function(e){var n=e.target;return t.setState({fileUploaded:n.files[0]})}}),this.state.fileUploaded&&Object(M.jsx)(b.a,{negative:!0,icon:"remove",content:this.state.fileUploaded.name,onClick:function(){t.setState({fileUploaded:null})}})]}):Object(M.jsx)(g.a,{error:!0,content:"Cannot connect to IPFS Node. Posts are limited to 60 characters."}),Object(M.jsxs)(g.a,{warning:!0,children:[Object(M.jsx)("p",{children:"Your wallet will prompt you for transaction confirmation. Verify transaction amount is 0 and to address is your own. The data input will be a hex encode of your post."}),Object(M.jsx)("p",{children:"After confirming in your wallet, the transaction may take some time to finalize on the blockchain based on network conditions. You can refresh from the header icon when your wallet notifies you of successful posting."})]})]})}),Object(M.jsxs)(m.a.Actions,{children:[Object(M.jsx)(b.a,{negative:!0,content:"Cancel",onClick:function(){return t.setState({addModalOpen:!1,postMessage:"",fileUploaded:null})}}),Object(M.jsx)(b.a,{content:"Post",labelPosition:"right",icon:"checkmark",positive:!0,disabled:!this.state.postMessage,onClick:this.onClickPostToMetamask.bind(this)})]})]}),Object(M.jsxs)(m.a,{open:this.state.ipfsModalOpen,children:[Object(M.jsx)(m.a.Header,{children:"Set IPFS Node"}),Object(M.jsx)(m.a.Content,{children:Object(M.jsx)(m.a.Description,{children:Object(M.jsx)(j.a,{fluid:!0,value:this.state.ipfsHost,onChange:function(e,n){var a=n.value;return t.setState({ipfsHost:a})}})})}),Object(M.jsxs)(m.a.Actions,{children:[Object(M.jsx)(b.a,{negative:!0,content:"Cancel",onClick:function(){return t.setState({ipfsModalOpen:!1})}}),Object(M.jsx)(b.a,{disabled:!this.state.ipfsHost||!this.state.ipfsHost.startsWith("http://")&&!this.state.ipfsHost.startsWith("https://"),content:"Save",labelPosition:"right",icon:"checkmark",positive:!0,onClick:function(){localStorage.setItem("ipfs",t.state.ipfsHost),window.location.reload()}})]})]})]})}}]),n}(s.a.Component),D=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,498)).then((function(e){var n=e.getCLS,a=e.getFID,s=e.getFCP,i=e.getLCP,o=e.getTTFB;n(t),a(t),s(t),i(t),o(t)}))};o.a.render(Object(M.jsx)(s.a.StrictMode,{children:Object(M.jsx)(R,{})}),document.getElementById("root")),D()}},[[476,1,2]]]);
//# sourceMappingURL=main.b39466de.chunk.js.map