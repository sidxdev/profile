(this.webpackJsonpprofile=this.webpackJsonpprofile||[]).push([[0],{218:function(t,e,n){},271:function(t,e){},282:function(t,e){},311:function(t,e){},312:function(t,e){},458:function(t,e,n){"use strict";n.r(e);var s=n(0),a=n.n(s),i=n(68),o=n.n(i),r=(n(218),n(219),n(1)),c=n.n(r),h=n(74),d=n(75),l=n(76),u=n(84),p=n(81),f=n(474),b=n(459),m=n(475),j=n(473),k=n(477),x=n(146),g=n(471),O=n(472),y=n(476),v=n(90),C=n.n(v),w=n(95),M=n(13),S=function(t){Object(u.a)(n,t);var e=Object(p.a)(n);function n(t){var s;Object(d.a)(this,n);var a="text",i=!1;return(s=e.call(this,t)).props.content.startsWith("https://")?(a="https",i=!0):s.props.content.startsWith("ipfs://")&&(a="ipfs",i=!0),s.state={text:!0,lazy:i,type:a,lazyText:"loading...",iconColor:"grey"},s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=Object(h.a)(c.a.mark((function t(){var e,n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.state.lazy){t.next=16;break}t.t0=this.state.type,t.next="https"===t.t0?4:"ipfs"===t.t0?10:4;break;case 4:return t.next=6,C.a.get(this.props.content);case 6:return e=t.sent,e.headers["content-type"].search("text/plain")>=0&&this.setState({lazyText:e.data,iconColor:"red"}),t.abrupt("break",16);case 10:return t.next=12,C.a.get("".concat("https://ipfs.io/ipfs/").concat(this.props.content.replace("ipfs://","")));case 12:return n=t.sent,n.headers["content-type"].search("text/plain")>=0&&this.setState({lazyText:n.data,iconColor:"teal"}),t.abrupt("break",16);case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return Object(M.jsxs)(y.a,{fluid:!0,raised:!0,style:{background:"dark"===this.props.theme?"black":"white"},children:[Object(M.jsx)(y.a.Content,{children:Object(M.jsx)(y.a.Description,{content:this.state.lazy?this.state.lazyText:this.props.content,style:{color:"dark"===this.props.theme?"white":"black"}})}),Object(M.jsxs)(y.a.Content,{extra:!0,style:{color:"dark"===this.props.theme?"white":"black"},children:[this.state.lazy&&Object(M.jsxs)(w.a,{attached:"top right",color:this.state.iconColor,size:"tiny",children:[this.state.type," "]}),this.props.date]})]})}}]),n}(a.a.Component);function T(t){return t.split("").map((function(t){return t.charCodeAt(0).toString(16).padStart(2,"0")})).join("")}var I=function(t){Object(u.a)(n,t);var e=Object(p.a)(n);function n(t){var s;return Object(d.a)(this,n),(s=e.call(this,t)).state={profileButtonDisable:!0,feed:[]},s}return Object(l.a)(n,[{key:"loadData",value:function(){var t=Object(h.a)(c.a.mark((function t(e){var n,s,a,i=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,C.a.get("https://api-testnet.polygonscan.com/api?module=account&action=txlist&address=".concat(e,"&startblock=1&endblock=99999999&sort=asc"));case 4:if(n=t.sent,"1"===(s=n.data).status&&Array.isArray(s.result)){t.next=8;break}return t.abrupt("return");case 8:a=s.result.filter((function(t){return t.to.toLowerCase()===i.props.id.toLowerCase()})).filter((function(t){return"0x"!==t.input})).filter((function(t,e,n){return n.findIndex((function(e){return e.hash===t.hash}))===e})).map((function(t){var e,n=t.hash,s=t.input,a=t.timeStamp;return{hash:n,content:(e=s,decodeURIComponent(e.replace(/\s+/g,"").replace(/[0-9a-f]{2}/g,"%$&").substring(2))),date:new Date(1e3*parseInt(a)).toString().substring(0,24)}})).reverse(),this.setState({feed:a});case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(M.jsxs)(g.a,{style:{marginTop:"2.5em"},children:[Object(M.jsx)(O.a,{hidden:!0}),Object(M.jsx)(y.a.Group,{children:this.props.id&&this.state.feed.map((function(e){return Object(M.jsx)(S,Object(x.a)(Object(x.a)({},e),{},{theme:t.props.theme}),e.hash)}))})]})}}]),n}(a.a.Component),z=(0,n(245).create)("http://localhost:5001"),D=function(t){Object(u.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n),t=e.call(this);var s="undefined"===typeof window.ethereum;return t.state={theme:localStorage.getItem("theme")||"light",connect:!1,disableConnect:s,id:"",addModalOpen:!1,postMessage:"",disableRefresh:!1},t.profile=a.a.createRef(),t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.setTheme(this.state.theme)}},{key:"onClickToggleTheme",value:function(){"dark"===this.state.theme?this.setTheme("light"):this.setTheme("dark")}},{key:"setTheme",value:function(t){this.setState({theme:t}),localStorage.setItem("theme",t),document.body.classList.remove("dark"),document.body.classList.remove("light"),document.body.classList.add(t)}},{key:"onClickConnect",value:function(){var t=this;this.state.connect?this.setState({connect:!1,id:""}):window.ethereum.request({method:"eth_requestAccounts"}).then((function(e){var n=e[0];t.setState({connect:!0,id:n}),t.profile.current.loadData(n)})).catch((function(e){t.setState({connect:!1,id:""})}))}},{key:"onClickAdd",value:function(){this.setState({addModalOpen:!0,postMessage:""})}},{key:"onClickPostToMetamask",value:function(){var t=Object(h.a)(c.a.mark((function t(){var e,n,s,a,i=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((e=this.state.postMessage).length>60)){t.next=9;break}return t.next=4,z.add(e,{pin:!0});case 4:s=t.sent,a=s.cid,n=T("ipfs://".concat(a.toString())),t.next=10;break;case 9:n=T(e);case 10:window.ethereum.request({method:"eth_sendTransaction",params:[{to:window.ethereum.selectedAddress,from:window.ethereum.selectedAddress,data:"0x".concat(n)}]}).then((function(t){})).catch((function(t){})).finally((function(t){return i.setState({addModalOpen:!1,postMessage:""})}));case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(M.jsxs)("div",{className:this.state.theme,children:[Object(M.jsxs)(f.a,{fixed:"top",compact:!0,borderless:!0,inverted:"dark"===this.state.theme,children:[Object(M.jsx)(f.a.Item,{header:!0,content:this.state.id?"Profile ".concat(this.state.id.substring(0,6),"...").concat(this.state.id.slice(-4)):"Profile"}),this.state.id&&Object(M.jsx)(f.a.Item,{icon:"refresh",disabled:this.state.disableRefresh,onClick:function(){t.profile.current.loadData(t.state.id),t.setState({disableRefresh:!0}),setTimeout((function(){return t.setState({disableRefresh:!1})}),2e3)}}),Object(M.jsx)(f.a.Item,{position:"right",icon:"dark"===this.state.theme?"moon":"sun",onClick:this.onClickToggleTheme.bind(this)}),Object(M.jsx)(f.a.Item,{name:this.state.disableConnect?"Install Metamask":this.state.connect?"Disconnect":"Connect",icon:this.state.disableConnect?"warning":"power",onClick:this.state.disableConnect?function(){window.open("https://metamask.io","_blank")}:this.onClickConnect.bind(this)})]}),Object(M.jsx)(I,{ref:this.profile,theme:this.state.theme,id:this.state.id}),Object(M.jsx)(b.a,{circular:!0,icon:"add",size:"big",onClick:this.onClickAdd.bind(this),style:{display:this.state.connect?"block":"none",position:"fixed",margin:"2em",bottom:"0px",right:"0px",zIndex:6}}),Object(M.jsxs)(m.a,{open:this.state.addModalOpen,children:[Object(M.jsx)(m.a.Header,{children:"Post a new Message"}),Object(M.jsx)(m.a.Content,{children:Object(M.jsxs)(m.a.Description,{children:[Object(M.jsx)(j.a,{fluid:!0,placeholder:"Enter your messsage",onChange:function(e,n){var s=n.value;return t.setState({postMessage:s})}}),Object(M.jsxs)(k.a,{warning:!0,children:[Object(M.jsx)("p",{children:"Metamask will prompt you for transaction confirmation. Verify transaction amount is 0 and to address is your own. The data input will be a hex encode of your post."}),Object(M.jsx)("p",{children:"After confirming in Metamask, the transaction may take some time to finalize on the blockchain based on network conditions. You can refresh from the header icon when Metamask notifies you of successful posting."})]})]})}),Object(M.jsxs)(m.a.Actions,{children:[Object(M.jsx)(b.a,{negative:!0,content:"Cancel",onClick:function(){return t.setState({addModalOpen:!1,postMessage:""})}}),Object(M.jsx)(b.a,{content:"Post",labelPosition:"right",icon:"checkmark",positive:!0,disabled:!this.state.postMessage,onClick:this.onClickPostToMetamask.bind(this)})]})]})]})}}]),n}(a.a.Component),A=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,480)).then((function(e){var n=e.getCLS,s=e.getFID,a=e.getFCP,i=e.getLCP,o=e.getTTFB;n(t),s(t),a(t),i(t),o(t)}))};o.a.render(Object(M.jsx)(a.a.StrictMode,{children:Object(M.jsx)(D,{})}),document.getElementById("root")),A()}},[[458,1,2]]]);
//# sourceMappingURL=main.a9b7d05d.chunk.js.map